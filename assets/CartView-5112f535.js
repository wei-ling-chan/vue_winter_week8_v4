import{_ as B,k as V,m as P,a as n,b as t,F as y,l as v,h as r,n as L,t as i,bs as k,bj as I,d as C,w,e as b,g as u,r as O,o as l,q as E,bi as R}from"./index-01093b7f.js";import{c as T}from"./cartStore-29c4a78d.js";import{S as p}from"./sweetalert2.all-dbef9969.js";import{T as h}from"./toasts-0cc83718.js";const A="/vue_winter_week8_v4/assets/eat-noodle-8bc494a7.png",{VITE_APP_URL:m,VITE_APP_PATH:f}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"wlc606",BASE_URL:"/vue_winter_week8_v4/",MODE:"production",DEV:!1,PROD:!0},U={data(){return{reEnter:!1,showEnter:"",products:[],productId:"",lodingItem:"",lodingItema:"",tempProduct:{},data:{user:{name:"",email:"",tel:""},message:""},coupon_code:"",discount_total_price:"",couponApplied:!1}},methods:{...V(T,["getCart"]),updateCart(s,o){if(o>=1){this.lodingItem=s.id;const _={product_id:s.product.id,qty:o};this.$http.put(`${m}/v2/api/${f}/cart/${s.id}`,{data:_}).then(g=>{h.fire({width:250,title:g.data.message,icon:"success"}),this.getCart(),this.lodingItem=""}).catch(g=>{this.showReEnter(g.response.data.message)})}},deleteCartItem(s){this.lodingItem=s.id,p.mixin({icon:"warning",toast:!0,backdrop:!0,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"刪除",cancelButtonText:"取消",confirmButtonColor:"#ff0000",cancelButtonColor:"#1b1b1b",didOpen:o=>{o.addEventListener("mouseenter",p.stopTimer),o.addEventListener("mouseleave",p.resumeTimer)}}).fire({title:`是否要刪除<span style="color: #7b7d42cc"> ${s.product.title} </span>？`}).then(o=>{o.isConfirmed&&this.$http.delete(`${m}/v2/api/${f}/cart/${s.id}`).then(_=>{this.lodingItem="",this.getCart(),p.fire({toast:!0,title:`已刪除<span style="color: #7b7d42cc"> ${s.product.title} </span>`,icon:"success",position:"top",showConfirmButton:!1,timer:1500})}).catch(_=>{h.fire({width:250,title:_.response.data.message,icon:"error"}),this.lodingItem=""}),this.lodingItem=""})},deleteCartAll(){this.lodingItem="123",p.mixin({icon:"warning",toast:!0,backdrop:!0,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"刪除",cancelButtonText:"取消",confirmButtonColor:"#ff0000",cancelButtonColor:"#1b1b1b",didOpen:s=>{s.addEventListener("mouseenter",p.stopTimer),s.addEventListener("mouseleave",p.resumeTimer)}}).fire({title:'是否要刪除<span style="color: #7b7d42cc"> 全部商品 </span>？'}).then(s=>{s.isConfirmed&&this.$http.delete(`${m}/v2/api/${f}/carts`).then(o=>{h.fire({width:250,title:'已刪除<span style="color: #7b7d42cc"> 全部商品 </span>',icon:"success"}),this.lodingItem="",this.getCart()}).catch(o=>{h.fire({width:250,title:o.response.data.message,icon:"error"}),this.lodingItem=""})})},order(){const s={data:this.data};this.$http.post(`${m}/v2/api/${f}/order`,s).then(o=>{this.$router.push(`/checkOrder/${o.data.orderId}`),this.$refs.form.resetForm()}).catch(o=>{h.fire({width:250,title:o.response.data.message,icon:"error"})}),this.cart="",this.$refs.form.resetForm()},showReEnter(s){this.showEnter=s},addCouponCode(){const s={code:this.coupon_code};this.$http.post(`${m}/v2/api/${f}/coupon`,{data:s}).then(o=>{this.discount_total_price=o.data.data.final_total,this.reEnter=!1,h.fire({width:270,title:o.data.message,icon:"success"}),this.lodingItem="",this.couponApplied=!0,this.$refs.coupon_input.value="",this.coupon_code="",this.getCart()}).catch(o=>{this.showReEnter(o.response.data.message),this.reEnter=!0,this.lodingItem=""})},resetForm(){this.$refs.form.resetForm()},nextCart(){this.$router.push("/cartFront")}},computed:{...P(T,["cart","total","final_total"])},mounted(){this.getCart()}},q=t("div",{class:"cart-space"},null,-1),M={class:"cart d-flex flex-column align-items-center mb-5 mb-md-8 mt-4"},N={key:0,class:"d-none d-md-block",style:{width:"100%"}},S=t("div",{class:"position-relative mx-auto mt-4 mb-lg-9 mb-md-8",style:{width:"50%"}},[t("div",{class:"progress",style:{height:"1px"}},[t("div",{class:"progress-bar",role:"progressbar",style:{width:"100%","background-color":"black"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})]),t("button",{type:"button",class:"position-absolute bg-success text-white top-0 start-0 translate-middle btn btn-sm btn-primary rounded-pill fs-7",style:{width:"6rem",height:"6rem"}}," 購物車 "),t("button",{type:"button",class:"position-absolute boeder border-dark bg-0 text-dark top-0 start-50 translate-middle btn btn-sm btn-primary rounded-pill fs-7",style:{width:"6rem",height:"6rem"}}," 填寫訂單 "),t("button",{type:"button",class:"position-absolute bg-primary text-dark top-0 start-100 translate-middle btn btn-sm btn-secondary rounded-pill fs-7",style:{width:"6rem",height:"6rem"}}," 完成訂單 ")],-1),F={class:"container text-end px-md-0 my-4"},$={class:"table align-middle fs-5 container"},z=t("thead",null,[t("tr"),t("tr",{class:"text-center fs-md"},[t("th",{class:"cart-product"},"商品"),t("th",{class:"cart-product"},"品名"),t("th",{class:"cart-product"},"數量"),t("th",{class:"cart-product"},"金額"),t("th",{style:{width:"20%"}})])],-1),D={class:"text-center"},j={key:0,class:"text-center text-info use-coupon"},H={class:"input-group mx-auto cart-amount"},G=["onClick","disabled"],J=t("i",{class:"bi bi-dash-lg"},null,-1),K=[J],Q=["value","onChange"],W=["onClick"],X=t("i",{class:"bi bi-plus"},null,-1),Y=[X],Z={class:"text-center position-relative"},tt={key:0},et={key:1,class:"text-center"},st={class:"text-center"},ot=["onClick","disabled"],nt=t("i",{class:"bi bi-trash3 fs-7"},null,-1),lt={key:0,class:"fas fa-spinner fa-pulse"},dt={style:{border:"0"},class:"fs-md"},at=t("td",{class:"text-end",style:{border:"0"}},null,-1),rt=t("td",{class:"text-end",style:{border:"0"}},null,-1),it=t("td",{style:{border:"0"}},null,-1),ct=t("td",{class:"text-center",style:{border:"0"}},"總計",-1),ut={key:0,class:"fs-md"},pt=t("td",{class:"text-end"},null,-1),ht=t("td",{class:"text-end"},null,-1),_t=t("td",null,null,-1),bt=t("td",{class:"text-center"},"折扣後金額",-1),mt={class:"text-center text-danger"},ft={class:"container px-md-0"},gt={class:"input-group input-group-sm coupon mt-5"},yt={class:"col-xl-3 col-md-3 me-2"},xt=["disabled"],vt={class:"col-xl-3 col-md-3"},kt={class:"input-group-append"},Ct=["disabled"],wt={class:"d-flex ms-auto"},It={type:"button",class:"btn btn-dark rounded-3 fs-8"},Et={key:0,class:"fs-6 mt-1"},Tt=t("i",{class:"fa-solid fa-triangle-exclamation me-1 text-info"},null,-1),At={key:1,class:"text-center"},Bt=t("div",{class:"d-flex flex-column justify-content-center"},[t("img",{src:A,class:"d-none d-md-block mx-auto",alt:"趕快去購買喔!",style:{width:"500px",height:"500px"}}),t("img",{src:A,class:"d-block d-md-none mx-auto",alt:"趕快去購買喔!",style:{width:"400px",height:"400px"}}),t("h1",{class:"h5 text-center mb-4 fw-normal"},"購物車還沒有任何商品喔!")],-1),Vt={type:"button",class:"btn btn-dark margin-auto"},Pt={key:2,class:"d-md-none px-11 table-responsive",style:{width:"100%"}},Lt=t("div",{class:"position-relative mx-auto m-5 mb-7",style:{width:"70%"}},[t("div",{class:"progress",style:{height:"1px"}},[t("div",{class:"progress-bar",role:"progressbar",style:{width:"100%","background-color":"black"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})]),t("button",{type:"button",class:"position-absolute bg-success text-white top-0 start-0 translate-middle btn btn-sm btn-primary rounded-pill fs-7",style:{width:"4rem",height:"4rem"}}," 購物車 "),t("button",{type:"button",class:"position-absolute boeder border-dark bg-0 text-dark top-0 start-50 translate-middle btn btn-sm btn-primary rounded-pill fs-7",style:{width:"4rem",height:"4rem"}}," 填寫訂單 "),t("button",{type:"button",class:"position-absolute bg-primary text-dark top-0 start-100 translate-middle btn btn-sm btn-secondary rounded-pill fs-7",style:{width:"4rem",height:"4rem"}}," 完成訂單 ")],-1),Ot={class:"table align-middle"},Rt=t("thead",null,[t("tr",null,[t("th",{class:"text-center"},"商品"),t("th",{class:"text-center"},"品名/數量"),t("th",{class:"text-center"},"金額"),t("th",{class:"text-center"})])],-1),Ut={class:"text-center"},qt={class:"d-flex flex-column"},Mt={class:"name-number mb-2"},Nt={key:0,class:"text-success d-none fs-7"},St={class:"input-group input-group-sm"},Ft=["onUpdate:modelValue","onChange","disabled"],$t=["value"],zt={class:"priced-flex flex-column"},Dt={key:0,class:"text-center"},jt={key:1,class:"text-center"},Ht={class:"text-center"},Gt=["onClick","disabled"],Jt={key:0,class:"fas fa-spinner fa-pulse"},Kt=t("td",{class:"text-end"},null,-1),Qt=t("td",{class:"text-end"},null,-1),Wt=t("td",{class:"text-center"},"總計",-1),Xt={class:"text-center"},Yt={key:0},Zt=t("td",{class:"text-end"},null,-1),te=t("td",{class:"text-end"},null,-1),ee=t("td",{class:"text-center"},"折扣後金額",-1),se={class:"text-center text-danger"},oe={class:"d-flex flex-column align-items-betw input-group input-group-sm coupon"},ne={class:"d-flex justify-content-between mt-1 mb-3"},le={class:"col-8 col-xl-3 col-md-12 me-2"},de=["disabled"],ae={class:"col-xl-3 col-md-12"},re={class:"input-group-append"},ie=["disabled"],ce={key:0,class:"fs-12 text-dark reEnter"},ue=t("i",{class:"fa-solid fa-triangle-exclamation me-1 mb-3"},null,-1),pe={class:"d-flex flex-column align-items-center"},he={type:"button",class:"btn btn-dark rounded-3 fs-8 w-50 mb-2 w-100"};function _e(s,o,_,g,d,a){const x=O("RouterLink");return l(),n(y,null,[q,t("div",M,[s.cart.carts&&Object.keys(s.cart.carts).length>0?(l(),n("table",N,[S,t("div",F,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:o[0]||(o[0]=(...e)=>a.deleteCartAll&&a.deleteCartAll(...e))}," 清空購物車 ")]),t("table",$,[z,t("tbody",null,[s.cart.carts?(l(!0),n(y,{key:0},v(s.cart.carts,e=>(l(),n("tr",{key:e.id,class:"fs-md"},[t("td",null,[t("div",{style:E([{width:"90%",height:"150px","background-size":"cover","background-repeat":"no-repeat","background-position":"center"},{backgroundImage:`url(${e.product.imageUrl})`}]),class:"cart-product cart-product-img rounded-3 mx-auto"},null,4)]),t("td",null,[t("div",D,i(e.product.title),1),e.coupon?(l(),n("div",j,"已套用優惠卷")):r("",!0)]),t("td",null,[t("div",H,[t("button",{class:"btn btn-outline-secondary rounded-start px-2",type:"button",onClick:b(c=>a.updateCart(e,e.qty-1),["prevent"]),disabled:e.qty===1},K,8,G),t("input",{type:"text",class:"form-control text-center",value:e.qty,onChange:c=>a.updateCart(e,e.qty),"aria-label":"Example text with two button addons",readonly:""},null,40,Q),t("button",{class:"btn btn-outline-secondary rounded-end px-2",type:"button",onClick:b(c=>a.updateCart(e,e.qty+1),["prevent"])},Y,8,W)])]),t("td",Z,[e.total!==e.final_total?(l(),n("div",tt,"NT$ "+i(Math.round(e.final_total)),1)):r("",!0),e.total===e.final_total?(l(),n("div",et,"NT$ "+i(e.total),1)):r("",!0)]),t("td",st,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:b(c=>a.deleteCartItem(e),["prevent"]),disabled:d.lodingItem===e.id},[nt,d.lodingItem===e.id?(l(),n("i",lt)):r("",!0)],8,ot)])]))),128)):r("",!0)]),t("tfoot",null,[t("tr",dt,[at,rt,it,ct,t("td",{class:L(["text-center",{"text-decoration-line-through":s.cart.total!==s.cart.final_total}]),style:{border:"0"}}," NT$ "+i(s.cart.total),3)]),s.cart.total!==s.cart.final_total?(l(),n("tr",ut,[pt,ht,_t,bt,t("td",mt,"NT$ "+i(Math.round(s.cart.final_total)),1)])):r("",!0)])]),t("div",ft,[t("div",gt,[t("div",yt,[k(t("input",{ref:"coupon_input",type:"text",class:"form-control me-3 rounded-3 fs-8","onUpdate:modelValue":o[1]||(o[1]=e=>d.coupon_code=e),disabled:d.couponApplied,placeholder:"請輸入優惠碼"},null,8,xt),[[I,d.coupon_code]])]),t("div",vt,[t("div",kt,[t("button",{class:"btn btn-outline-secondary rounded-3 fs-8",type:"button",disabled:d.couponApplied,onClick:o[2]||(o[2]=(...e)=>a.addCouponCode&&a.addCouponCode(...e))},i(d.couponApplied?"優惠碼已套用":"套用優惠碼"),9,Ct)])]),t("div",wt,[t("button",It,[C(x,{to:"/products",class:"nav-link fs-8"},{default:w(()=>[u("繼續購物")]),_:1})]),t("button",{type:"button",class:"btn btn-info ms-4 rounded-3 text-white fs-8",onClick:o[3]||(o[3]=b((...e)=>a.nextCart&&a.nextCart(...e),["prevent"]))},"下一步")])]),d.reEnter?(l(),n("div",Et,[Tt,u(i(d.showEnter),1)])):r("",!0)])])):(l(),n("div",At,[Bt,t("button",Vt,[C(x,{to:"/products",class:"nav-link"},{default:w(()=>[u("繼續購物")]),_:1})])])),s.cart.carts&&Object.keys(s.cart.carts).length>0?(l(),n("div",Pt,[Lt,t("table",Ot,[Rt,t("tbody",null,[s.cart.carts?(l(!0),n(y,{key:0},v(s.cart.carts,e=>(l(),n("tr",{key:e.id},[t("td",null,[t("div",{class:"rounded-3 mx-auto",style:E([{height:"100px","background-size":"cover","background-position":"center",width:"100px"},{backgroundImage:`url(${e.product.imageUrl})`}])},null,4)]),t("td",Ut,[t("div",qt,[t("div",Mt,[u(i(e.product.title)+" ",1),e.coupon?(l(),n("div",Nt,"已套用")):r("",!0)]),t("div",St,[k(t("select",{name:"",id:"",class:"form-select","onUpdate:modelValue":c=>e.qty=c,onChange:c=>a.updateCart(e,e.qty),disabled:d.lodingItem===e.id},[(l(),n(y,null,v(20,c=>t("option",{value:c,key:c+"45621"},i(c),9,$t)),64))],40,Ft),[[R,e.qty]])])])]),t("td",null,[t("div",zt,[e.total===e.final_total?(l(),n("div",Dt,i(e.total),1)):r("",!0),e.total!==e.final_total?(l(),n("div",jt,i(Math.round(e.final_total)),1)):r("",!0)])]),t("td",Ht,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:c=>a.deleteCartItem(e),disabled:d.lodingItem===e.id},[d.lodingItem===e.id?(l(),n("i",Jt)):r("",!0),u(" x ")],8,Gt)])]))),128)):r("",!0)]),t("tfoot",null,[t("tr",null,[Kt,Qt,Wt,t("td",Xt,i(s.cart.total),1)]),s.cart.total!==s.cart.final_total?(l(),n("tr",Yt,[Zt,te,ee,t("td",se,i(Math.round(s.cart.final_total)),1)])):r("",!0)])]),t("div",oe,[t("div",ne,[t("div",le,[k(t("input",{ref:"coupon_input",type:"text",class:"form-control me-3 rounded-3 fs-8 molbile-size","onUpdate:modelValue":o[4]||(o[4]=e=>d.coupon_code=e),disabled:d.couponApplied,placeholder:"請輸入優惠碼"},null,8,de),[[I,d.coupon_code]])]),t("div",ae,[t("div",re,[t("button",{class:"btn btn-outline-secondary fs-8 rounded-3 molbile-size",type:"button",disabled:d.couponApplied,onClick:o[5]||(o[5]=(...e)=>a.addCouponCode&&a.addCouponCode(...e))},i(d.couponApplied?"優惠碼已套用":"套用優惠碼"),9,ie)])])]),d.reEnter?(l(),n("div",ce,[ue,u(i(d.showEnter),1)])):r("",!0),t("div",pe,[t("button",he,[C(x,{to:"/products",class:"nav-link"},{default:w(()=>[u("繼續購物")]),_:1})]),t("button",{type:"button",class:"btn btn-info rounded-3 text-white fs-8 w-100",onClick:o[6]||(o[6]=b((...e)=>a.nextCart&&a.nextCart(...e),["prevent"]))},"下一步")])])])):r("",!0)])],64)}const ye=B(U,[["render",_e]]);export{ye as default};
